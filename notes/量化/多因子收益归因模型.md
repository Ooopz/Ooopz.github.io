---
tags:
- 收益归因
---

# 多因子收益归因模型

[[Brinson 收益归因模型]]计算简单，并且清晰地反应了从板块配置到板块内选股的投资思路，因而其在业绩归因方面的应用十分广泛。然而，[[Brinson 收益归因模型]]仍然存在局限性。

首先，需要对个 股进行严格的板块划分。对于行业分类来说，对个股的分类很少会存在问题，而在风格分类下，对个股风格的划分就存在很大的不确定性。例如，在区分大盘股小盘股时，大小盘的区分标准很难确定，而常用的分位数分组方法存在很大的随机性，两个市值差别很小的股票可能会分属于不同的板块。

其次，当根据风格和行业进行选股时，为了使用 [[Brinson 收益归因模型]]进行归因分析，就需要将股票按照风格及行业分组，此时需要分组的数量为风格数量 × 行业数量，组数的增加使得归因分析的复杂性急剧上升，并且使其结论难以理解。 在这种情况下，基于多因子模型的业绩归因的优势就会显现出来。

实际上，Brinson 模型可以看作多因子模型的一个[[多因子收益归因模型#多因子模型推导Brision|特例]]。首先，多因子模型能够较好地解决多维度的归因问题，如风格与行业。其次，Brinson 模型中的选股效应也可以通过各种风格因子来解释。Brinson 模型与多因子模型的结合使用，能够更加清晰明了地对收益进行分解。

多因子模型将股票收益率分解为可以由共同因子解释的部分以及特质部分, 即

$$r_{n}=\Sigma_{k} X_{n k} f_{k}+u_{n}$$

其中,  $X_{n k}$ 为股票 $n$ 在因子 $k$ 上的暴露,  $f_{k}$ 为因子 $k$ 的因子收益,  $u_{n}$ 为股票 $n$ 的残差收益。

因此, 组合收益为：

$$R^{P}=\Sigma_{n} w_{n}^{P} r_{n}=\Sigma_{k} X_{k}^{P} f_{k}+\Sigma_{n} w_{n}^{P} u_{n}$$

其中 $w_{n}^{P}$ 为组合中股票 $n$ 的权重,  $X_{k}^{P}$ 为组合对在因子 $k$ 上的暴露。

当使用该模型进行归因分析时, 组合因子暴露 $X_{k}^{P}$ 在期初已知, 因子收益 $f_{k}$ 在期末估计得到,  $X_{k}^{P} f_{k}$ 就是该期因子 $k$ 对组合的收益贡献。

可以看到, 组合的收益来源于对正向（或负向）收益因子的正向（或负向）暴露以及对具有正向特质收益个股的超配。然而在多因子组合中, 投资者想要撷取的是共同因子带来的收益, 而不是个股的特质收益。因此, 在使用多因子模型进行业绩归因时更加关注各个因子带来的收益。

使用多因子模型进行归因需要期初组合的因子暴露, 以及期末估计的因子收益, 下面就具体介绍因子暴露以及因子收益的估计。

## 组合因子暴露

组合因子暴露为个股因子暴露的加权平均, 即：

$$X_{k}^{P}=\Sigma_{n} w_{n}^{P} X_{n k}$$

其中,  $w_{n}^{P}$ 为组合中股票 $n$ 的权重, $X_{n k}$ 为股票 $n$ 在因子 $k$ 上的暴露。

组合的因子暴露在期初即可确定。

下表列出了本文使用的风格因子。对于一个类别中的因子, 使用滚动 24 期 ( 20 个交 易日为一期 ) IC_IR 加权的方法合成该类因子。当一个因子类别中只有一个因子时, 该因子值乘以滚动 24 期  / C_{-} / R  。由于每类因子都在原因子上乘以因子的方向, 因此各因子的预期方向都是正向的, 即对因子的暴露越高, 预期收益越高。

本文使用中信行业分类作为行业因子。在中信一级行业分类的基础上，采用中信二级 行业分类进一步划分银行和非银金融行业，具体地，将银行业分为国有银行和股份制与城 商行，将非银行金融分为证券、保险和信托及其他，共计 32 个行业。当然，根据不同的 行业划分需求，对于各行业可选取不同的细分等级。 以前文组合为例，下图展示了两个组合在期初（即 20170630）的因子暴露。可以看 到，首先，两个组合的风格暴露较为相似，都对 BP、一致预期 EP、成长以及非线性市值、 市值因子的暴露较大；其次，与组合 B 相比，组合 A 在这些因子上的暴露都更加极端一些。

## 因子收益

因子收益的估计可以通过横截面回归得到，使用下一期个股收益率对上一期个股因子 暴露进行回归，回归系数即为因子收益。本报告参考 Barra USE4（The Barra US Equity Model）、CNE5(The Barra China Equity Model) 估计因子收益率。股票收益率可以表示为 市场收益率、行业收益率、风格因子收益率以及特质收益率的线性组合：

因子收益的估计可以通过横截面回归得到, 使用下一期个股收益率对上一期个股因子 暴露进行回归, 回归系数即为因子收益。本报告参考 Barra USE4 (The Barra US Equity Model) CNE5(The Barra China Equity Model) 估计因子收益率。股票收益率可以表示为 市场收益率、行业收益率、风格因子收益率以及特质收益率的线性组合:

$$r_{n}=f_{m}+\Sigma_{i} X_{i}^{I} f_{i}^{\mathrm{I}}+\Sigma_{i} X_{i}^{S} f_{i}^{\mathrm{S}}+u_{n}$$

其中 $r_{n}$ 为股票收益率,  $f_{m}$ 为市场收益,  $f_{i}^{\mathrm{I}}$ 为行业 $i$ 的因子收益,  $f_{i}^{\mathrm{S}}$ 为风格 $i$ 的因子收益, $X_{i}^{I}$, $X_{i}^{S}$ 分别为股票 $n$ 对行业 $i$  、风格 $i$ 的因子暴露, $u_{n}$ 为特质收益率。

由于股票收益率存在异方差性, 因此以根号市值作为权重, 使用加权最小二乘法估计以上模型。使用这种加权方法是由于很多研究发现个股的特质风险与股票规模成反比。

此外, 由于行业因子暴露使用哑变量表示全部行业, 加入截距项 $f_{m}$ 使得模型中存在共线性。可通过增加以下约束条件使得该模型具有唯一解：

$$\Sigma_{\mathrm{i}} w_{i} f_{i}^{\mathrm{I}}=0$$

即市值加权的行业因子平均收益为 $0$ , 其中 $w_{i}$ 为行业 $i$ 的市值权重。

在该约束条件下, 截距项 $f_{m}$ 的含义就更加明确,  $f_{m}$ 实际上代表了全市场市值加权收益率; 而行业因子的回归系数代表了行业的超额收益, 风格因子的回归系数代表了在控制行 业因素的影响后, 风格因子的超额收益。

可以在不同频率下估计因子收益, 如日度, 月度。下图为各风格因子在 2017 年 7 月 的月度因子收益。组合月初的因子暴露与月末估计的因子收益的乘积, 就是当月该因子对组合的收益贡献。

可以看到，BP、一致预期 EP 以及成长因子的因子收益为正向的，而组合 A 和组合 B 在这些因子上的正向暴露为组合贡献了正向的收益；而市值因子的因子收益是负向的，而两个组合对市值因子的正向暴露为组合带了的负向的收益。

如果每天都估计一次因子收益，将因子收益累计求和，就可以得到各个因子的收益曲线。可以看到，市值因子的收益曲线在 2017 年 7 月中发生了大幅的变化。

对比两个组合在 2017 年 7 月超额收益的表现，可以看到组合 A 在 7 月中发生了明显的回撤。对比因子收益与组合收益回撤的时间，会发现两者时间是重合的，均为 2017 年 7 月 17 日（图 4 中因子收益曲线的日期对应估计因子收益时因子暴露的日期）。因此，很容易发现，组合 A 该次回撤与市值因子的收益变化有关。结合前文，组合 A 相比组合 B 对市值因子的暴露更多，就不难理解在市值因子收益剧烈变动时，组合 A 会受到更大的冲击。

## 因子收益贡献

通过将组合收益分解到各因子维度上，可以看到在各个因子上的超额暴露是否能够给组合带来超额收益。

期初组合的因子暴露与期末估计得到的因子收益的乘积, 就是该期因子对组合的收益贡献。具体地, 因子 k 对组合的收益贡献为：

$$R C_{k}=X_{k}^{P} f_{k}=\Sigma_{n} w_{n}^{P} X_{n k} \cdot f_{k}$$

其中,  $X_{k}^{P}$ 为组合期初在因子 $k$ 上的暴露，为个股因子暴露的加权平均，$w_{n}^{P}$ 为组合中股票 $n$ 的权重，$X_{n k}$ 为股票 $n$ 在因子 $k$ 上的暴露，$f_{k}$ 为期末估计的因子 k 的因子收益。

表 3 为 2017 年 7 月各因子对两个组合的收益贡献。其中, 因子收益为 2017 年 7 月各因子的因子收益, 相对暴露为 2017 年 6 月 30 日组合相对基准在各因子上的暴露, 收益贡献为因子收益与相对暴露的乘积。

可以看到, 市值因子对两个组合的收益贡献都是负向的, 而 BP 因子、一致预期 EP 因 子、成长因子等对组合的收益贡献是正向。由于组合 A 在市值因子上的暴露更多, 市值因 子对组合 A 的负向收益贡献更大。

## 行业内因子暴露与因子收益

前文展示的是在全市场估计的因子收益，然而在不同股票池中，估计得到的风格因子 收益可能会存在较大的差别。以一致预期 EP 因子为例，如图 6 所示，2017 年 7 月，该因 子在不同行业内估计得到的因子收益在方向以及大小上存在明显差别。

同样的，以一致预期 EP 因子为例，如图 7 所示，在 2017 年 6 月 30 日，组合 A 各个行业在该因子上的暴露呈现较大的差别，其中医药、基础化工、轻工制造、食品饮料行业对该因子的相对暴露都在 1.5 以上，而农林牧渔、建材、建筑等行业对该因子的相对暴露 低于 0.5。

将行业内因子暴露与行业内因子收益结合起来看，会发现食品饮料行业的一致预期 EP 因子收益是负向的，但是该行业却对该因子具有较大的正向暴露，因此在该期，一致预期 EP 因子对食品饮料行业的收益贡献是负向的。 因此，为了更加细致地了解组合的收益来源，可以在各个行业内部使用多因子模型进行归因，计算组合各个行业内的因子暴露以及各行业内因子收益的方向，从而明确各个因子对行业超额收益的贡献。

## 多因子模型推导Brision