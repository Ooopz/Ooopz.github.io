# 绝对中位差

在统计学中，绝对中位差 $MAD$ 是对单变量数值型数据的样本偏差的一种鲁棒性测量。同时也可以表示由样本的 $MAD$ 估计得出的总体参数。

对于单变量数据集 $X_{1}, X_{2}, \ldots, X_{n}$，$MAD$ 定义为数据点到中位数的绝对偏差的中位数：

$$
MAD = \operatorname{median}\left(\left|X_{i}-\operatorname{median}(X)\right|\right)
$$

也就是说，先计算出数据与它们的中位数之间的残差（偏差），$MAD$ 就是这些偏差的绝对值的中位数。

考虑数据集(1, 1, 2, **2**, 4, 6, 9)，它的中位数为 2。数据点到 2 的绝对偏差为(1, 1, 0, 0, 2, 4, 7)，该偏差列表的中位数为 1（因为排序后的绝对偏差为(0, 0, 1, **1**, 2, 4, 7)）。所以该数据的绝对中位差为 1。

绝对中位差是一种统计离差的测量。而且，$MAD$ 是一种*鲁棒统计量*，比标准差更能适应数据集中的异常值。对于标准差，使用的是数据到均值的距离平方，所以大的偏差权重更大，异常值对结果也会产生重要影响。**对于 $MAD$，少量的异常值不会影响最终的结果**。

由于 $MAD$ 是一个比样本方差或者标准差更鲁棒的度量，它对于不存在均值或者方差的分布效果更好，比如[[柯西分布]]。

为了能将 $MAD$ 当作标准差 $\sigma$ 估计的一种一致估计量，使用

$$
\hat{\sigma} = k \cdot MAD
$$

其中 $k$ 为比例因子常量，值取决于分布类型。

对于正态分布数据，$k$ 的值为：

$$
k = 1 / \left(\Phi^{-1}(3 / 4)\right) \approx 1.4826
$$

也就是标准正态分布 $Z = X / \sigma$ 的分位函数的倒数（逆累积分布函数）。数值 3/4 是为了 $\pm MAD$ 包含标准正态累积分布函数的 50%（从 1/4 到 3/4 的范围值），也就是：

$$
\frac{1}{2} = P(|X-\mu| \leq MAD) = P \left(\left|\frac{X-\mu}{\sigma}\right| \leq \frac{MAD}{\sigma}\right) = P\left(|Z| \leq \frac{MAD}{\sigma}\right)
$$

所以，必须有：

$$
\Phi(MAD / \sigma)-\Phi(-MAD / \sigma) = 1 / 2
$$

而

$$
\Phi(-MAD / \sigma) = 1-\Phi(MAD / \sigma)
$$

得到$MAD / \sigma = \Phi^{-1}(3 / 4) = 0.67449$，从而比例因子$k = 1 / \Phi^{-1}(3 / 4) = 1.4826$ 。
